# 📊 비용 데이터 정제 가이드

## 🎯 목적
엑셀 파일의 비용 데이터를 웹 대시보드에서 사용할 수 있는 형식으로 변환합니다.

## 📋 진행 순서

### 1단계: Python 설치 확인
```bash
python --version
```
- Python 3.7 이상이 필요합니다
- 없다면 https://www.python.org/downloads/ 에서 설치

### 2단계: 필요한 라이브러리 설치
```bash
pip install pandas openpyxl
```

### 3단계: 데이터 정제 스크립트 실행
```bash
cd "d:\OneDrive - F&F\바탕 화면\hmcursor"
python excel_data_cleaner.py
```

## 📁 입력 파일
- **위치**: `d:\OneDrive - F&F\바탕 화면\hmcursor\`
- **파일명**:
  - `2024.1-12.XLSX` (2024년 1~12월 데이터)
  - `2025.1-10.XLSX` (2025년 1~10월 데이터)

## 📤 출력 파일
- **위치**: `C:\Users\AD0815\cost-dashboard\public\data\`
- **생성되는 파일**:
  - `cost_202401.csv` ~ `cost_202412.csv` (2024년 월별)
  - `cost_202501.csv` ~ `cost_202510.csv` (2025년 월별)
  - `cost_all.csv` (전체 통합 파일)

## 📊 데이터 변환 내용

### 원본 데이터 구조
```
Cost ctr | Cost ctr desc | Cost Elem | Cost Elem desc | 202401 | 202402 | ... | CURR | 사용여부 | 영업비구분 | 사업부 | 부서명 | 대분류 | 중분류
```

### 변환 후 데이터 구조
```csv
년월,년,월,법인,본부,팀,계정과목,금액,영업비구분,사업부,대분류
2024-01,2024,01,MANAGEMENT,MGT,급여,인건비,552735.67,중국본사,공통,인건비
```

## 🔧 정제 규칙

### 1. 필터링
- ✅ **사용여부 = '사용'** 인 데이터만 포함
- ✅ **금액 ≠ 0** 인 데이터만 포함
- ❌ **사용여부 = '제외'** 데이터는 제외

### 2. 데이터 변환
- **금액**: 쉼표(,) 제거 후 숫자로 변환
- **Cost ctr desc** → **법인**
- **부서명** → **본부**
- **중분류** → **팀**
- **Cost Elem desc** → **계정과목**

### 3. 추가 정보
- **년월**: YYYY-MM 형식 (예: 2024-01)
- **년**: YYYY 형식
- **월**: MM 형식

## 📈 예상 결과

### 2024년 데이터
- **원본**: 2,491행
- **정제 후**: 약 1,500~2,000행 (월별 약 125~167행)
- **기간**: 2024-01 ~ 2024-12 (12개월)

### 2025년 데이터
- **원본**: 2,383행
- **정제 후**: 약 1,200~1,800행 (월별 약 120~180행)
- **기간**: 2025-01 ~ 2025-10 (10개월)

### 전체 통합
- **총 기간**: 22개월
- **총 데이터**: 약 2,700~3,800행

## ✅ 성공 확인

스크립트 실행 후 다음을 확인하세요:

1. **파일 생성 확인**
```bash
dir "C:\Users\AD0815\cost-dashboard\public\data\cost_*.csv"
```

2. **파일 개수 확인**
   - 월별 파일: 22개 (2024년 12개 + 2025년 10개)
   - 통합 파일: 1개

3. **콘솔 출력 확인**
   - "✅ 정제 완료!" 메시지
   - 데이터 요약 정보
   - 법인, 본부, 계정과목 목록

## 🐛 문제 해결

### 오류: "No module named 'pandas'"
```bash
pip install pandas openpyxl
```

### 오류: "파일을 찾을 수 없습니다"
- 파일명 확인: `2024.1-12.XLSX`, `2025.1-10.XLSX`
- 파일 위치 확인: `d:\OneDrive - F&F\바탕 화면\hmcursor\`

### 오류: "Permission denied"
- 출력 디렉토리의 기존 파일이 열려있는지 확인
- Excel이나 다른 프로그램에서 파일을 닫고 재실행

## 🚀 다음 단계

데이터 정제가 완료되면:

1. **웹 대시보드 실행**
```bash
cd C:\Users\AD0815\cost-dashboard
npm run dev
```

2. **브라우저에서 확인**
   - http://localhost:3000 접속
   - 정제된 CSV 파일이 자동으로 로드됨

3. **데이터 확인**
   - 필터링 기능 테스트
   - 차트 확인
   - 통계 카드 확인

## 💡 팁

### 데이터 업데이트 시
1. 새로운 엑셀 파일을 `hmcursor` 폴더에 저장
2. `excel_data_cleaner.py` 스크립트 재실행
3. 웹 대시보드 새로고침

### 커스터마이징
- **필터 조건 변경**: 스크립트의 `process_excel_file` 함수 수정
- **컬럼 추가/제거**: 컬럼 리스트 수정
- **출력 경로 변경**: `OUTPUT_DIR` 변수 수정

---

**작성일**: 2024-11-11  
**버전**: 1.0

